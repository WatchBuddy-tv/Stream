{% extends "_html_taban.html.j2" %}
{% block breadcrumbs %}{% endblock %}

{% block icerik %}

<!-- Global Arama -->
<div class="search-container">
    <div class="search-form">
        <input 
            type="text" 
            id="global-search-input" 
            class="search-input" 
            placeholder="{{ tr('search_all_placeholder') }}" 
            data-i18n="search_all_placeholder"
            data-i18n-attr="placeholder"
            autocomplete="off"
        >
        <button type="button" id="global-search-button" class="search-button">
            <i class="fas fa-search"></i>
        </button>
    </div>
</div>

<!-- Arama Sonuçları -->
<section id="search-results" class="search-results" style="display: none;">
    <div class="detail-container">
        <div class="detail-header">
            <h2 class="detail-title">
                <i class="fas fa-search"></i> <span data-i18n="search_results_title">{{ tr('search_results_title') }}</span>: <span id="search-query-display"></span>
            </h2>
            <button id="clear-search" class="button button-secondary">
                <i class="fas fa-times"></i> <span data-i18n="search_clear">{{ tr('search_clear') }}</span>
            </button>
        </div>
        
        <!-- Plugin Filtreleri -->
        <div id="plugin-filters" class="plugin-filters" style="display: none;">
            <div class="filters-header">
                <h3 class="filters-title">
                    <i class="fas fa-filter"></i> <span data-i18n="providers_title">{{ tr('providers_title') }}</span>
                </h3>
                <button id="clear-filters" class="button button-small button-secondary" aria-label="{{ tr('filters_clear') }}" data-i18n="filters_clear" data-i18n-attr="aria-label">
                    <i class="fas fa-times"></i> <span data-i18n="filters_clear">{{ tr('filters_clear') }}</span>
                </button>
            </div>
            <div id="filters-container" class="filters-container"></div>
        </div>

        <div id="search-status" class="search-status"></div>
        <div id="results-grid" class="grid"></div>
    </div>
</section>

<!-- Eklenti Listesi -->
<section id="plugins-list">
    <h2 class="section-title">
        <i class="fas fa-plug"></i> <span data-i18n="all_plugins">{{ tr('all_plugins') }}</span>
    </h2>
    
    <div class="grid">
        {% for plugin in plugins %}
            <div class="card">
                <div class="card-content">

                    <div class="card-header">
                        {% if plugin.favicon %}
                            <img src="{{ plugin.favicon }}" alt="{{ plugin.name }}" class="plugin-favicon">
                        {% else %}
                            <i class="fas fa-film plugin-icon"></i>
                        {% endif %}

                        <h3 class="card-title">
                            {{ plugin.name }}
                            <hr>
                            <small><span data-i18n="language_label">{{ tr('language_label') }}</span>: {{ plugin.language }}</small>
                        </h3>
                    </div>

                    <p class="card-text">{{ plugin.description }}</p>
                    <p class="card-text"></p>

                    <div class="card-actions">
                        <a href="{{ plugin.main_url }}" target="_blank" class="button button-secondary">
                            <i class="fas fa-external-link-alt"></i> <span data-i18n="site_button">{{ tr('site_button') }}</span>
                        </a>
                        <a href="/eklenti/{{ plugin.name }}{{ lang_query }}" class="button">
                            <i class="fas fa-eye"></i> <span data-i18n="details_button">{{ tr('details_button') }}</span>
                        </a>
                    </div>

                </div>
            </div>
        {% endfor %}
    </div>
</section>

{% endblock %}

{% block js %}
    <script>
        window.availablePlugins = {{ plugins | tojson | safe }};
    </script>
    <script type="module" src="{{ url_for('static_home', path='JS/global-search.min.js') }}" defer crossorigin="anonymous"></script>
{% endblock %}
